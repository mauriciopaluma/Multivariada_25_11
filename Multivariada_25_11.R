y_1_barra = matrix(c(15.97, 15.91, 27.19, 22.75), ncol = 1);y_1_barra
y_2_barra = matrix(c(12.34, 13.91, 16.66, 21.94), ncol = 1);y_2_barra

S1 <- matrix(c(5.192, 4.545, 6.522, 5.250, 
               4.545, 13.18, 6.76, 6.266,
               6.522, 6.76, 28.67, 14.47,
               5.25, 6.266, 14.47, 16.65), ncol = 4, byrow = T);S1
S2 <- matrix(c(9.136, 7.549, 4.864, 4.151,
               7.544, 18.6, 10.22, 5.446,
               4.864, 10.22, 30.04, 13.49,
               4.151, 5.446, 13.49, 28), ncol = 4, byrow = T);S2
n1 = 32; n1
n2 = 32; n2

Sc = ( (n1-1)*S1 + (n2-1)*S2 )/(n1+n2-2); Sc

t = ( (n1*n2)/(n1+n2) ) * ( t(y_1_barra-y_2_barra) %*% solve(Sc) %*% (y_1_barra-y_2_barra) );t

p = 4; p

f = ( n1 + n2 - p - 1 ) / ( (n1+n2-2)*p ) * t; f

F1 = qf(0.99, p, n1 + n2 - p - 1);F1

F1 * ( ((n1 + n2 - 2)*p) / (n1+n2-p-1) ) 

       